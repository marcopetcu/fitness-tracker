<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="https://www.thymeleaf.org/thymeleaf-extras-springsecurity6"
      lang="ro">
<head>
  <meta charset="UTF-8"><title>Foods</title>
  <link rel="stylesheet" th:href="@{/css/style.css}" href="/css/style.css">
  <link rel="stylesheet" th:href="@{/css/foods.css}" href="/css/foods.css">
</head>
<body>
<header class="topbar">
  <nav class="nav">
    <a class="nav__brand" th:href="@{/}">MyApp</a>
    <ul class="nav__list">
      <li><a class="nav__link" th:href="@{/}"><span class="icon"><svg viewBox="0 0 24 24"><path d="M3 12l9-9 9 9-2 0v8h-5v-5H10v5H5v-8H3z"/></svg></span>Home</a></li>
      <li><a class="nav__link" th:href="@{/journal}"><span class="icon"><svg viewBox="0 0 24 24"><path d="M6 4h11a2 2 0 012 2v14l-3-2-3 2-3-2-3 2V6a2 2 0 012-2z"/></svg></span>Journal</a></li>
      <li><a class="nav__link nav__link--active" th:href="@{/food}"><span class="icon"><svg viewBox="0 0 24 24"><path d="M7 2h10l1 5H6l1-5zm-1 7h12l-1.5 13H7.5L6 9z"/></svg></span>Foods</a></li>
      <li><a class="nav__link" th:href="@{/workouts}"><span class="icon"><svg viewBox="0 0 24 24"><path d="M5 6h2v12H5V6zm12 0h2v12h-2V6zM9 9h6v6H9V9z"/></svg></span>Workouts</a></li>
      <li><a class="nav__link" th:href="@{/exercises}"><span class="icon"><svg viewBox="0 0 24 24"><path d="M7 10h10v4H7zM3 11h3v2H3zm15 0h3v2h-3z"/></svg></span>Exercises</a></li>
      <li><a class="nav__link" th:href="@{/admin/muscle-groups}"><span class="icon"><svg viewBox="0 0 24 24"><path d="M4 8h16v8H4z"/></svg></span>Muscle Groups</a></li>
      <li><a class="nav__link" th:href="@{/profile}"><span class="icon"><svg viewBox="0 0 24 24"><path d="M12 12a5 5 0 100-10 5 5 0 000 10zm-7 9v-1a7 7 0 0114 0v1H5z"/></svg></span>Account</a></li>
    </ul>
  </nav>
</header>

<main class="container">
  <h1 class="page-title">Foods</h1>

  <!-- Search + New -->
  <form th:action="@{/food}" method="get" class="card search-bar">
    <input class="input" type="text" name="q" th:value="${q}" placeholder="Search by name">
    <button class="btn" type="submit">Search</button>
    <a class="btn" type="button" th:href="@{/food/new}" sec:authorize="hasRole('ADMIN')">+ New Food</a>
  </form>

  <!-- Table -->
  <section class="card">
    <table class="table">
      <thead>
      <tr>
        <th>Name</th><th>Kcal/100g</th><th>Fat (g)</th><th>Carbs (g)</th><th>Protein (g)</th>
        <th sec:authorize="hasRole('ADMIN')">Actions</th>
      </tr>
      </thead>
      <tbody>
      <tr th:each="f : ${page.content}">
        <td th:text="${f.name}">Name</td>
        <td th:text="${f.kcal}">0</td>
        <td th:text="${f.fat}">0</td>
        <td th:text="${f.carbs}">0</td>
        <td th:text="${f.protein}">0</td>
        <td sec:authorize="hasRole('ADMIN')">
          <a th:href="@{'/food/' + ${f.id} + '/edit'}">Edit</a>
          <form th:action="@{'/food/' + ${f.id} + '/delete'}" method="post" class="inline-form">
            <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}">
            <button class="btn btn--danger" type="submit" onclick="return confirm('Delete?')">Delete</button>
          </form>
        </td>
      </tr>
      </tbody>
    </table>
  </section>

  <!-- Pagination -->
  <div class="pagination">
    <span th:text="'Page ' + ${page.number + 1} + ' / ' + ${page.totalPages}">Page</span>
    <div>
      <a th:if="${!page.first}" th:href="@{|/food?page=${page.number - 1}&size=${page.size}&q=${q}|}">« Prev</a>
      <a th:if="${!page.last}" th:href="@{|/food?page=${page.number + 1}&size=${page.size}&q=${q}|}">Next »</a>
    </div>
  </div>
</main>

<div class="footer-space"></div>
</body>
</html>
